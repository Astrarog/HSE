\documentclass[a4paper,12pt]{article}

\usepackage{cmap}					% поиск в PDF
\usepackage[T2A]{fontenc}			% кодировка
\usepackage[utf8]{inputenc}			% кодировка исходного текста
\usepackage[english,russian]{babel}	% локализация и переносы
\usepackage{enumitem}  				% смена типа символя у enumerate
\usepackage{amsmath,amsfonts,amssymb,amsthm,epsfig,epstopdf,titling,url,array}
\usepackage{icomma} 				% "Умная" запятая: $0,2$ --- число, $0, 2$ --- перечисление
\usepackage{hyperref}				% кликабельные ссылки
\usepackage{soulutf8} 				% Модификаторы начертания
\usepackage{mathrsfs}				% теоремы
\usepackage{tabularx}				% X таблицы
\usepackage[backend=biber,
			bibencoding=utf8,
			bibstyle=numeric,
			sorting=none]			% цитирование в порядке появляения в тексте
		{biblatex}					% библиография
\usepackage{xparse} 				% для переопределения section* subsection* и пр., чтобы те появлялись в оглавлении
\usepackage[ruled,
			linesnumbered,
			vlined]
		{algorithm2e}				% красивые алгоритмы
		
\usepackage{mathtools}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\sloppy

\SetAlgorithmName{Алгоритм}{algo}{Список алгоритмов}
\SetKwInput{KwData}{Вход}
\SetKwInput{KwResult}{Выход}
\SetNlSty{textbf}{}{.}
\SetAlgoNlRelativeSize{0}
\SetKwIF{If}{ElseIf}{Else}{Если}{то}{иначе если}{иначе}{}

\addbibresource{sources.bib}

\theoremstyle{definition}
\newtheorem{defn}{Определение}

\newtheoremstyle{underline}% name
{}        % Space above, empty = `usual value'
{}              % Space below
{}              % Body font
{\parindent}    % Indent amount (empty = no indent, \parindent = para indent)
{}              % Thm head font
{.}             % Punctuation after thm head
{0.8ex}         % Space after thm head: \newline = linebreak
{\textit{{\underline{\thmname{#1}\thmnumber{ #2}}}\thmnote{(#3)}}}  % Thm head spec

\theoremstyle{underline}
\newtheorem{example}{Пример}

\let\oldsection\section
\makeatletter
\newcounter{@secnumdepth}
\RenewDocumentCommand{\section}{s o m}{%
	\IfBooleanTF{#1}
	{\setcounter{@secnumdepth}{\value{secnumdepth}}% Store secnumdepth
		\setcounter{secnumdepth}{0}% Print only up to \chapter numbers
		\oldsection{#3}% \section*
		\setcounter{secnumdepth}{\value{@secnumdepth}}}% Restore secnumdepth
	{\IfValueTF{#2}% \section
		{\oldsection[#2]{#3}}% \section[.]{..}
		{\oldsection{#3}}}% \section{..}
}
\makeatother




\author{Астраханцев Роман Геннадьевич}
\title{ОТЧЕТ о прохождении производственной практики}
\date{2022 г.}

\begin{document} % Конец преамбулы, начало текста.
	
	\thispagestyle{empty}
	\begin{center}
		Федеральное государственное автономное учреждение \\ высшего профессионального образования \\

		НАЦИОНАЛЬНЫЙ ИССЛЕДОВАТЕЛЬСКИЙ УНИВЕРСИТЕТ \\ <<ВЫСШАЯ ШКОЛА ЭКОНОМИКИ>> \\
		\vspace{2ex}
		Образовательная программа «Компьютерная безопасность» \\
	\end{center}

	\begin{center}
		\vspace{15ex}
		\textbf{\so{КУРСОВАЯ РАБОТА} \\ \vspace{3ex} Анализ материалов по теме \\ <<Эндоморфизмы на эллиптических кривых>>}
	\end{center}

	\vspace{17ex}

	\hspace{0.6\linewidth} 	\textbf{Выполнил:} 
	
	\hspace{0.6\linewidth}  студент группы СКБ-171 
	
	\hspace{0.6\linewidth}  Астраханцев Р.Г. 


	
	\begin{center}
		
		\vfill
		\textbf{Москва, 2022}
	\end{center}
	
	\newpage
	\tableofcontents
	
	\newpage
	\section*{ВВЕДЕНИЕ}
	
	В криптографических схемах на основе эллиптических кривых умножение точки на число является наиболее времязатратной операцией. Иными словами, вычиление кратной точки $k P$, где $k$ -- целое число, а $P$ -- точка на эллиптической кривой $E$, определённой над конечным полем $\mathbb{F}_q$, считается довольно медленной операцией. Базовой техникой вычисления этой точки служит алгоритм удвоения-и-сложения, который работает за $\log_2 k$ операций сложения на эллиптической кривой. Множество методов для ускорения произведения были предложены в литературе \cite{gordon1998survey, hankerson2000software, menezes2018handbook}, например:
	
	\begin{enumerate}
		\item Общие методы, которые позволяют ускорить вычисления в любой конеченой абелевой группе.
			\begin{enumerate}
				\item Использование таблиц предварительных вычислений \cite{lim1994more}, зависящих от базовой точки $P$. Они могут быть применимы в случая, когда $P$ фиксировано.
				\item Использование цепочек сложения, когда $k$ фиксировано.
				\item Оконные методы, когда базовая точка $P$ не известна.
				\item Одновременное использование нескольких методов для вычисления выражений вида $k_1 P_1 + \ldots + k_s P_s$
			\end{enumerate}

		\item Методы экспоненциального перекодирования, которые заменяют двоичное представление $k$ другим с меньшим количеством ненулевых знаков \cite{gollmann1996redundant}.
		
		\item Методы, характерные для умножения точек на эллиптических кривых.
			\begin{enumerate}
				\item Выбор конечного поля $\mathbb{F}_q$ таким образом, чтобы вычисления в нём происходили быстрее. Например, выбор поля $F_q$, где $q$ -- это простое число Мерсена \cite{solinas1999generalized}.
				\item Выбор представления конечного поля $\mathbb{F}_q$ таким образом, чтобы вычисления в нём происходили быстрее. Например, выбор неприводимого трехчлена в качестве примитивного многочлена для расширения бинарных полей.
				\item Выбор представления точки $P$, которая позволяет проводить опреации сложения и умножения быстрее \cite{cohen1998efficient}.
				\item Выбор эллиптических кривых со специальными свойствами, как например кривых Коблица \cite{koblitz1991cm}
			\end{enumerate}
	\end{enumerate}

	Основное приемущество кривых Коблица заключается в том, что на них можно использовать эндоморфизм Фробениуса для быстрого умножения точек. А именно, методы Солинаса \cite{solinas1997improved, solinas2000efficient} на этих кривых не используют удвоений точек вообще. Данные методы могут быть обощены на случай произвольного эндоморфизма, однако в целом это не эффективно.
	
	Тем не менее, для эллипических кривых, у которых существует эффективно-вычислимый эндоморфизм можно добиться увеличения скорости вычисления кратной точки путём декомпозиции числа $k$ по некторому модулю $n$ на составные части и применения одного преобразования эндоморфзма. Хотя для кривых Коблица данный метод уступает по скорости методам Солинаса, он всё ещё полезен на более широком классе кривых (в частности, кривых, определённых над $\mathbb{F}_q$, где $q$ -- простое число). Кроме того, такой подход позволяет добиться ускорения даже в случае, когда преобразование эндомофризма дороже, чем операции над точками.
	
	\newpage
	
	\section{Идея применения эффектиных эндоморфизмов}
	
	Под $E$ будем понимать эллипитческую кривую определённую над конечным полем $\mathbb{F}_q$. Точку на бесконечности будем обозначать как $\mathcal{O}$. Группу точек кривой $E$, рациональных над $\mathbb{F}_{q^n}, n \geqslant 1$, будем обозначать как $E(\mathbb{F}_{q^n})$.
	
	\begin{defn}\label{def:endo}
	\emph{Эндоморфизмом} эллиптической кривой $E$ будем называть любое \emph{регулярное} (пиблжиаемое рациональными функциями) отоборажение $\phi:~E~\rightarrow~E $, удовлетворяющее соотношению $\phi(\mathcal{O}) = \mathcal{O}$.
	\end{defn}

	В некоторых случаях отобржаение $\phi$ эквивалентно умножению на некоторое целое число $\lambda$ по модулю $n$, поэтому $\phi(P) = \lambda P$, что может быть полезно в вычислении точки $k P$. Иными словами, если мы можем эффективно представить $k = k_1 + k_2 \lambda \pmod{n}$, где $k_1, k_2 \in [0, \ceil{\sqrt{n}}]$, то мы получим.

	\begin{equation} \label{eq:decomp}
		\begin{aligned}
			kP &= (k_1 + k_2 \lambda) P = \\
			   &= k_1 P + (k_2 \lambda) P = \\
   			   &= k_1 P + k_2 (\lambda P) = \\
   			   &= k_1 P + k_2 \phi(P) \\
		\end{aligned}
	\end{equation}
	
	Теперь разложение \ref{eq:decomp} можно эффективно вычислить используя алгоритмы типа "множественного экспоненциирования" \cite{moller2001algorithms}, которые специализрованные на вычилении выражения $k_1 P + k_2 Q$, где $P, Q \in E$.
	
	В силу выбранных ограничений на уполовинивание бинарных разложений $k_1$ и $k_2$ удалось избавиться от большинства увдоений точек. Итоговая сложность алгоритма без анализа ускорения от алгоритма "множественного экспоненциирования" составляет $\leqslant (\log_2 k) / 4$ удвоений точек.
	
	Стоит отметить, что можно добиться ещё большего ускорения в случае, когда применение преобразования эндоморфизма быстрее, чем увдоение точки. Так, например, в оконных методах при вычилении выражения $k_1 P + k_2 Q$ формируются таблицы с точками $\epsilon P$ и $\epsilon Q$ для маленьких значений $\epsilon$. Условие $Q=\phi (P)$ позволяет нам при вычислении таблиц использовать $\epsilon Q = \epsilon \phi (P) = \phi (\epsilon P)$. Это избавит от необходимости вычилять $\epsilon Q$ классическим способом, а использовать более эффективный.
	
	
	\newpage	
	\section{Примеры эффективных эндоморфизмов}
	
	Приведём примеры эллиптических кривых и эффиктивно вычислимых на них эндоморфизмов. 
	
	\begin{example}
		Пусть $m\in \mathbb{Z}$. Отображение $\phi: E \rightarrow E$ такое, что для любой точки $P \in E$ по определению $\phi(P) = m P$ является эндоморфизмом.
	\end{example}
	
	\begin{example}
		Пусть $E$ - эллипитческая кривая, определённая над конечным полем $\mathbb{F}_q$. Отображение $\phi: E \rightarrow E$, которое действует по правилу  \[(x, y) \mapsto (x^q, y^q)\] и $\mathcal{O} \mapsto \mathcal{O}$, является эндоморфизмом и называется эндомофризмом Фробениуса. Вычиление такого эндоморфизма является быстрой операцией.
	\end{example}

	\begin{example}
		Пусть $p \equiv 1 \pmod{4}$ -- простое число, а $E$ - эллиптическая кривая, определённая над $\mathbb{F}_p$. Пусть $E$ задаётся уравнением 
	
		\begin{equation}
			y^2 = x^3 + a x.
		\end{equation}
		Пусть $\alpha \in \mathbb{F}_p$ -- элемент порядка 4. Тогда отображение $\phi: E \rightarrow E$, которое действует по правилу  
		\[ (x, y) \mapsto (-x, \alpha y) \] 
		и $\mathcal{O} \mapsto \mathcal{O}$, является эндоморфизмом. Если $P \in E(\mathbb{F}_p)$ -- точка порядка $n$, то тогда $\phi$ действует на $\langle P\rangle$ как умножение на число $\lambda$, удовлетворяющему уравнению $\lambda^2 \equiv -1 \pmod{n}$. Иными словами $\forall Q \in \langle P\rangle$ $\phi(Q) = \lambda Q$.
	
	\end{example}

	\begin{example}
		Пусть $p \equiv 1 \pmod{3}$ -- простое число, а $E$ - эллиптическая кривая, определённая над $\mathbb{F}_p$. Пусть $E$ задаётся уравнением 
		
		\begin{equation}
			y^2 = x^3 + b.
		\end{equation}
		Пусть $\beta \in \mathbb{F}_p$ -- элемент порядка 3. Тогда отображение $\phi: E \rightarrow E$, которое действует по правилу  
		\[(x, y) \mapsto (\beta x, y)\]
		 и $\mathcal{O} \mapsto \mathcal{O}$, является эндоморфизмом. Если $P \in E(\mathbb{F}_p)$ -- точка порядка $n$, то тогда $\phi$ действует на $\langle P\rangle$ как умножение на число $\lambda$, удовлетворяющему уравнению $\lambda^2 + \lambda \equiv -1 \pmod{n}$. Иными словами $\forall Q \in \langle P\rangle$ $\phi(Q) = \lambda Q$.
		
	\end{example}

	\begin{example}
		Пусть $p>3$ -- простое число, такое, что $-7$ является полным квадратом в $\mathbb{F}_p$, пусть $\omega = (1+\sqrt{-7})/2$ и $a = (\omega - 3)/4 $. Пусть эллиптическая кривая $E$, определённая над $\mathbb{F}_p$ задаётся уравнением
	
		\begin{equation}
			y^2 = x^3 - \frac{3}{4} x^2 - 2 x - 1.
		\end{equation}
		Тогда отображение $\phi: E \rightarrow E$, которое действует по правилу 
		\[ (x, y) \mapsto \left(\omega^{-2} \frac{x^2 - \omega}{x - a}, \omega^{-3} y \frac{x^2 - 2 a x + \omega}{(x - a)^2}\right) \]
		и $\mathcal{O} \mapsto \mathcal{O}$, является эндоморфизмом. Затраты на его вычисление немного больше, чем удвоение точки.
	
	\end{example}

	\begin{example}
		Пусть $p>3$ -- простое число, такое, что $-2$ является полным квадратом в $\mathbb{F}_p$. Пусть эллиптическая кривая $E$, определённая над $\mathbb{F}_p$ задаётся уравнением
		
		\begin{equation}
			y^2 = 4x^3 -30 x - 28.
		\end{equation}
		Тогда отображение $\phi: E \rightarrow E$, которое действует по правилу 
		\[ (x, y) \mapsto \left(- \frac{2x^2 + 4x + 9}{4(x + 2)}, -y \frac{2x^2 + 8x - 1}{4 \sqrt{-2} (x + 2)^2}\right) \]
		и $\mathcal{O} \mapsto \mathcal{O}$, является эндоморфизмом. Затраты на его вычисление немного больше, чем удвоение точки. 
		
	\end{example}
	
	\section{Декомпозиция $k$}
	
	Важным вопросом в применении данного подхода будет разложение числа $k$ по известным $n, \lambda$ на соотношение $k \equiv k_1 + k_2 \lambda \pmod{p}$, то есть найти маленькие значения $k_1$ и $k_2$. Это означет, что вектор $(k_1, k_2) \in \mathbb{Z} \times \mathbb{Z}$ должен иметь небольшую Евклидову норму.
	
	Рассмотрим гомоморфизм $f: \mathbb{Z} \times \mathbb{Z} \rightarrow \mathbb{Z}_n$, который задаётся формулой $(x, y)  \mapsto (x + \lambda y \mod n) $. Задача состоит в том, чтобы найти \emph{маленький} вектор $u \in  \mathbb{Z} \times \mathbb{Z}$ такой, что $f(u)=k$. Стоит заметить, что задача заключается именно в нахождении короткого вектора, ведь $u=(k, 0)$ удовлетворяет условию $f(u)=k$.
	
	Для начала найдём два линейно независимых вектора $v_1, v_2 \in \mathbb{Z} \times \mathbb{Z}$  такие, что $f(v_1)=f(v_2)=0$. Для этого рассмотрим последовательности, которые возникают в ходе работы расширенного алгоритма Евклида при нахождении НОД$(n, \lambda)=1$. В ходе работы алгоритма возникает последовательность уравнений 
	
	\begin{equation} \label{extEuclid}
		s_i n + t_i \lambda = r_i, \text{ для } i=0,1,2,...,
	\end{equation}
	
	где $s_0=1, t_0=0, r_0=n, s_1=0, t_1=1, r_1=\lambda$, и $r_i \geqslant 0$ $\forall i$. Известно, что последовательности $\{s_i\}, \{t_i\}, \{r_i\}$ обладают следубщими свойствами
	
	\begin{enumerate}[label=\arabic*),topsep=0pt,itemsep=-0.5ex,partopsep=1ex,parsep=1ex]
		\item $r_i > r_{i+1} \geqslant 0 \ \forall i \geqslant 0$
		\item $|s_i| < |s_{i+1}| \ \forall i \geqslant 1$
		\item $|t_i| < |t_{i+1}| \ \forall i \geqslant 0$
		\item \label{magic} $r_{i-1}|t_i| + r_i|t_{i-1}| = n \ \forall i \geqslant 1$ 
	\end{enumerate}

	Пусть $m$ -- это наибольший индекс, при котором $r_m \geqslant \sqrt{n}$. Тогда в силу свойства \ref{magic} имеем $|t_{m+1}| < \sqrt{n}$. 
	
	Выберем $v_1=(r_{m+1}, -t_{m+1})$, тогда в силу \eqref{extEuclid} выполнено $f(v_1)=0$. А поскольку $|t_{m+1}| < \sqrt{n}$ и $|r_{m+1}| < \sqrt{n}$ (в сиду выбора $m$), то $||v_1|| \leqslant \sqrt{2n}$.
	
	Выберем в качестве $v_2$ наименьший по норме из векторов $(r_m, -t_m)$ и $(r_{m+2}, -t_{m+2})$. Опять в силу \eqref{extEuclid} имеем $f(v_2)=0$. Не трудно показать, что из-за свойств последовательностей $\{s_i\}, \{t_i\}, \{r_i\}$ вектора $v_1$ и $v_2$ будут линейно независимыми.
	
	Стоит заметить, что вектора $v_1$ и $v_2$ зависят только от $n$ и $\lambda$, а следовательно могут быть предварительно вычислены.
	
	Теперь найдём вектор $v$ близкий к $(k, 0)$ как линейную комбинацию $v_1$ и $v_2$. Рассмотрим вектора $(k, 0), v_1, v_2$ как элементы из $\mathbb{Q} \times \mathbb{Q}$. В таком случае линейное разложение $(k,0)= \beta_1 v_1 + \beta_2 v_2$ находится быстро, где $\beta_1, \beta_2 \in \mathbb{Q}$. Округлим полученные $\beta_1, \beta_2$ до ближайших целых чисел: $b_1 = \lfloor \beta_1 \rceil, b_2 = \lfloor \beta_2 \rceil$ и выберем $v = b_1 v_1 + b_2 v_2$. 
	
	Полученный вектор $v$ обладает свойством $f(v)=b_1 f(v_1) + b_2 f(v_2) = 0$. В качестве искомого вектора $u$ выберем $u=(k, 0) - v$. Заметим, что $f(u) = f\left((k,0)\right) - f(v) = k$. Лекго доказывается, что $||u|| \leqslant \max(||v_1||, ||v_2||).$

	\newpage
	\section*{ЗАКЛЮЧЕНИЕ}
	
	По некоторым оценкам представленный в работе метод позволяет ускорить вычисления кратной точки на 50\% в сравнении с классическими методами. Преимуществом данного подхода является его применимость к широкому классу эдллипитических кривых, чем другие методы.
	
	Классы эллиптических кривых с эффективно-вычислимыми эндоморфизмами должны быть рассмотрены как "специальные". Такие классы кривых можно использовать в криптографических схемах, в которых требуется большая эффективность взамен небольшому уменьшению стойкости этой схемы.
	
	\newpage
	\printbibliography[title={БИБЛИОГРАФИЧЕСКИЙ СПИСОК}]
		
	
\end{document} % Конец текста.
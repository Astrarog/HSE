\documentclass[a4paper,12pt]{article}

\usepackage{cmap}					% поиск в PDF
\usepackage[T2A]{fontenc}			% кодировка
\usepackage[utf8]{inputenc}			% кодировка исходного текста
\usepackage[english,russian]{babel}	% локализация и переносы
\usepackage{enumitem}  				% смена типа символя у enumerate
\usepackage{amsmath,amsfonts,amssymb,amsthm,epsfig,epstopdf,titling,url,array}
\usepackage{icomma} 				% "Умная" запятая: $0,2$ --- число, $0, 2$ --- перечисление
\usepackage{hyperref}				% кликабельные ссылки
\usepackage{soulutf8} 				% Модификаторы начертания
\usepackage{mathtools}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}

\usepackage{amstext} % for \text macro
\usepackage{array}   % for \newcolumntype macro
\newcolumntype{L}{>{$}l<{$}} % math-mode version of "l" column type
\newcolumntype{R}{>{$}r<{$}} % math-mode version of "r" column type
\newcolumntype{C}{>{$}c<{$}} % math-mode version of "c" column type


\usepackage[backend=biber,
			bibencoding=utf8,
			maxcitenames=2,
			style=authoryear]	
		{biblatex}					% библиография

\addbibresource{sources.bib}

\newtheorem{theorem}{Теорема}[section]
\newtheorem{corollary}[theorem]{Следствие}


\theoremstyle{definition}
\newtheorem{property}{Свойство}[subsection]
\renewcommand\theproperty{\arabic{property}}

\usepackage[ruled,
			linesnumbered,
			vlined]
		{algorithm2e}				% красивые алгоритмы

\SetAlgorithmName{Алгоритм}{algo}{Список алгоритмов}
\SetKwInput{KwData}{Вход}
\SetKwInput{KwResult}{Выход}
\SetNlSty{textbf}{}{.}
\SetAlgoNlRelativeSize{0}
\SetKwIF{If}{ElseIf}{Else}{Если}{то}{иначе если}{иначе}{}
\SetKwFor{ForEach}{Для каждого}{}{fintq}%
\SetKwFor{While}{Пока}{}{fintq}%


\usepackage[shortcuts]{extdash}

\graphicspath { {img} }

\sloppy

\title{Исследование поточного алгоритма шифрования типа «Раскольников» \linebreak Вариант №4.}
\author{Роман Астраханцев, СКБ-171}

\begin{document}
	\maketitle
	
	\section*{Описание алгоритма}

	\includegraphics[width=\textwidth]{cipher}


	Поточный алгоритм шифрования типа «Раскольников» состоит из:
	
	\begin{enumerate}
	\item трех РСЛОС $L_i, i \in \overline{1,3}$, над полем $\mathbb{F}_2$ c характеристическими многочленами
	$F_1(x), F_2(x), F_3(x)$ степени соответственно $n_1, n_2, n_3$.
	
	\item трех коммутаторов (перестановок) $K_i, i \in \overline{1,3}, Ki \in S (l_i)$, на вход коммутатору $K_i$
	подаются значения РСЛОС $L_i$ с индексами
	\[ 1 = p1 < p2 < \dots < p_{l_i-1} < p_{l_i} = n_i \]

	\item трех функций усложнения выхода РСЛОС $f_i (x_1, x_2, \dots, x_{l_i}), i \in \overline{1,3},$ 
	
	\item комбинирующей булевой функции $g(x,y,z)$, задаваемой формулой ($\land$ -- <<и>>, $\neg$ -- отрицание, $\lor$ -- <<или>>, $\veebar$ -- <<исключающее или>>):
	\[ g(x,y,z) = (\neg x \lor \neg y) \land (x \lor y \lor \neg z) \land (\neg y \lor z) \]
	
	\end{enumerate}

	Ключом являются:
	
	\begin{itemize}[topsep=0pt, itemsep=0pt, parsep=0pt]
	\item начальное заполнение регистра $L_1$
	\item коммутатор $K_2$
	\item начальное заполнение регистра $L_3$
	\end{itemize}

	\section{Исследование ключевого множества}
	
	Множетсво ключей $K$ состоит из всезможожных троек вида $(k_1, k_2, k_3)$, где 
	
	\begin{itemize}[topsep=0pt, itemsep=0pt, parsep=0pt]
	\item $k_1$ - какое-то заполнение регистра $L_1$ длины $n_1$,
	\item $k_2$ - какая-то перестановка длины $n_2$, 
	\item $k_3$ - какое-то заполнение регистра $L_3$ длины $n_1$.
	\end{itemize}
	
	Тогда общее число ключей будет равно
	
	\[ |K| = 2^{n_1} \cdot n_2! \cdot 2^{n_3} \]
	
	Приведём пример параметров $n_1, n_2, n_3$, при котором $|K| > 2^{64}$. Пусть $n_1=25, n_2=10, n_3=25$, тогда
	
	\[ |K| = 2^{25} \cdot 10! \cdot 2^{25} > 2^{25} \cdot 2^{21} \cdot 2^{25} > 2^{71} > 2^{64} \]
	
	\section{Исследование узлов алгоритма}
	
	\subsection{Узлы РСЛОС} \label{Узлы РСЛОС}
	
	\textit{Регистр сдвига с линейной обратной связью} или \textit{РСЛОС} --- это блок, который генерирует двоичные псевдослучайные периодические последовательности, которые называются линейными рекуррентными последовательностями (ЛРП). 
	
	Широкое распространение в криптографических приложениях линейных регистров сдвига над конечными полями $\mathbb{F}_{2^n}$ и кольцами вычетов обусловлено целым рядом факторов. Среди них можно отметить:
	
	\begin{itemize}[topsep=0pt, itemsep=0pt, parsep=0pt]
		\item использование только простейших операций сложения и умножения, аппаратно реализованных практически на всех вычислительных средствах;
		\item высокое быстродействие создаваемых на их основе криптографических алгоритмов;
		\item большое количество теоретических исследований свойств линейных рекуррентных последовательностей (ЛРП), свидетельствующих об их удовлетворительных криптографических свойствах
	\end{itemize}

	В данном шифре в ключ входят только заполнения регистра сдвига, а вид характеристического многочлена, является параметром построения шифра. Значит, нужно подобрать такие функции обратной связи, чтобы для любого \textbf{ненулевого} заполнения ЛРП была максимального периода. В этом нам помогут следующие теормы и следствие из них.
	
	\begin{theorem}
		Пусть $u$ – ЛРП над полем $\mathbb{F}_q$ с реверсивным минимальным многочленом $F(x)$ степени $m$ и $q^m > 2$. Тогда следующие утверждения эквивалентны:
		\begin{enumerate}[topsep=0pt, itemsep=0pt, parsep=0pt, label=(\arabic*)]
			\item $u$ – ЛРП максимального периода;
			\item многочлен $F(x)$ неприводим над $\mathbb{F}_q$, и его корень $\alpha$ в минимальном поле разложения $\mathbb{F}_{q^m}$ над $\mathbb{F}_q$ есть примитивный элемент поля.
		\end{enumerate}
	\end{theorem}

	\begin{theorem}
		Неприводимый многочлен $F(x)$ примитивен в том и только в том случае, когда для любого простого числа $p$, делящего $q^m - 1$, 
		многочлен $x^{\frac{q^m - 1}{p}}$ не сравним с 1 по модулю многочлена $F(x)$.

	\end{theorem}
	
	\begin{corollary}
		Если $F(x)$ -- неприводимый многочлен над полем $\mathbb{F}_2$ степени $m$, и $2^m - 1$ -- простое число, то $F(x)$ -- примитивный многочлен.

	\end{corollary}

	Исходя из утверждений выше, для того чтобы линейная рекуррентная последовательность порядка $m$ над полем из $q$ элементов имела
	максимальный период, необходимо и достаточно, чтобы ее минимальный многочлен был примитивным многочленом.
	
	Более конкретно, над полем $\mathbb{F}_2$ необходимо реверсивный минимальный многочлен $F(x)$ на основе просых чисел Мерсенна. В этом случае для любого \textbf{ненулевого} заполнения ЛРП получается максимального периода.
	
	Приведём конкретный пример многочленов $F_1(x), F_2(x), F_3(x)$ для заданных нашим алгоритмом РСЛОС $L_1, L_2, L_3$. Для их генерации будем использовать втроенные функции пакета Wolfram Mathematica 
	
	Пусть $n_1=31, n_2=13, n_3=19$ ($2^{31}-1, 2^{13}-1$ и $2^{19}-1$ --- это известные числа Мерсенна).
	
	Пример неприодимых многочленов соотвествующих степеней из $\mathbb{F}_2$[x].
	\begin{align*}
		F_1(x) =& x^{31} + x^{30} + x^{29} + x^{28} + x^{27} + x^{24} + x^{21} + x^{19} + \\
			    &+ x^{18} + x^{13} + x^{12} + x^{10} + x^4 + x^3 + 1 \\[2ex]
		F_2(x) =& x^{13} + x^{12} + x^{11} + x^8 + x^7 + x^6 + x^5 + x^4 + x^2 + x + 1 \\[2ex]
		F_3(x) =& x^{19} + x^{15} + x^{13} + x^{12} + x^{10} + x^9 + x^5 + x^4 + x^2 + x + 1 
	\end{align*}
	
	В этом случае любое \textbf{ненулевое} заполнение каждого из $L_1, L_2, L_3$ даст нам максимальный период на каждом из регистрах. Кроме того, каждый регистр сдвига был выбран разной длинны для того, чтобы исключить случай совместного зацикливания двух ЛРП. Иными словами итоговый период совместной работы всех трёх регистров будет равна 
	
	\[ N_{L_1 L_2 L_3} = \text{НОК}(2^{n_1}-1, 2^{n_2}-1, 2^{n_3}-1) = \text{НОК}(2^{31}-1, 2^{13}-1, 2^{19}-1) \approx 2^{63} \]

	Это означает, что вектор начальных заполнений $(u_1, u_2, u_3)$ регистров $L_1, L_2, L_3$ вернётся в сам в себя после $N_{L_1 L_2 L_3} \approx 2^{63} $ совместных тактов работы всех трёх регистров.
	
	При этом мощность ключевого множества по-прежнему будет удовлетворять условию $|K| > 2^{64}$:
	
	\[ |K| = 2^{31} \cdot 13! \cdot 2^{19} > 2^{31} \cdot 2^{32} \cdot 2^{19} > 2^{82} > 2^{64} \]
	
	\subsection{Функции усложнения} \label{Функции усложнения}
	
	Для усложнения аналитической сложности выходной	последовательности РСЛОС используются функции усложнения. «Фильтрующая» функция f должна выбираться так, чтобы выходная последовательность имела распределение, близкое к равномерному распределению, и высокую линейную сложность.

	
	Ниже представленые основные криптографические характеристики нелинейных преобразований, используемые в поточных шифрах.
	
	
	\begin{property}
		Функция $f$ фильтрующего генератора должна быть сбалансированной, т.е.  $|\{x : f(x) = 0\}| = 2^{n-1} $.  
	\end{property}

	\begin{property} \label{prop::zapr}
		У функция $f$ фильтрующего генератора должны отсуствовать запреты. 
	\end{property}

	Для выполненеия свойтсва \ref{prop::zapr} достаточно, чтобы функция $f$ была линейна по крайней переменной. Есть более общий критерий определения имеет ли булева фунция запрет или нет.
	
	\begin{theorem}
		Булева функция не имеет запрета тогда и только тогда, когда она сильно равновероятна.

	\end{theorem}

	\begin{property} 
		У функция $f$ фильтрующего генератора должна иметь высокую алгебраическую степень.
	\end{property}

	\begin{property} 
		Функция $f$ фильтрующего генератора должна иметь высокую нелинейность, т.е. не иметь эффективных линейных статистических аналогов.
	\end{property}

	\begin{property} 
		Функция $f$ фильтрующего генератора должна быть $k$\-/равновероятной для максимально возможного значения $k$.
	\end{property}
	
	\begin{property} 
		Функция $f$ фильтрующего генератора (а также функция $f~+~1$) не должны иметь аннигиляторов малой алгебраической степени.
	\end{property}
	
	
	На практикте помимо достежния перечисленных условий необходимо дополнительно исследовать весь блок фильтрующего гереатора целиком.
	Например, фильтрующий генератор с нелинейной функцией усложнения может представляться в виде ЛРП с меньшим (чем исходная ЛРП) периодом.
	
	В работе \textcite{rachwalik2012generation} были найдены несколько функций усложнения порядков 25 и 27. Работа была нацелена на поиск таких фукнций, что обеспечивают наибольший период выходной последовательности. Кроме того у перечисленных в работе булевых функций были ислледованы некоторые статистические свойства выходных последовательностей. Возьмём эти функции усложнения за основу, приняв некоторые переменные за единицу.
	
	\begin{align*}
		f_1 =& x_0 \oplus x_6 \oplus x_{11} \oplus x_{14} \oplus x_{16} \oplus x_{17} \oplus x_{18} \oplus x_{19} \oplus x_{23} \oplus\\
			 &\oplus x_{4} x_{19} \oplus x_{4} x_{21} \oplus x_5 x_{22} \oplus x_9 x_{19} \oplus x_1 x_{17} x_23 \oplus x_5 x_7 x_{18} \oplus x_5 x_{12} x_{19} \\[2ex]
		f_2 =& x_0 \oplus x_3 \oplus x_6 \oplus x_{10} \oplus x_6 x_9 \oplus x_6 x_{10}
\oplus x_4 x_9 x_{10} \\[2ex]
		f_3 =& x_0 \oplus x_8 \oplus x_9 \oplus x_{10} \oplus x_{11} \oplus x_{10} x_{14} \oplus x_4 x_{16}\oplus x_{11} x_{16} \oplus x_1 x_5 x_7 
	\end{align*}
	
	\subsection{Комбинирующая функция}
	
	\subsubsection{Вычление многочлена Жегалкина}
		
	\[ g(x,y,z) = 1 \oplus y \oplus z \oplus x z\]

	\subsubsection{Характеристики}
	
	Вычислим характерсики комбинирующей функции, которые позволят нам определить возможность применения разлинчых методов атак.
	
	Из вида многочлена жегалкина видно, что \textbf{степень нелинейности} функции $g$ равна 2. 
	
	Булева функция $h = x y$ является \textbf{аннигилятором} функции $g$, поскольку
	\[ h g = \left(1 \oplus y \oplus z \oplus x z \right) xy = xy \oplus xy \oplus xyz \oplus xyz = 0 \]

	Из предыдущего пункта видно, что \textbf{вес} функции $|g(x,y,z)| = 4$. Это означает, что функция $g$ является \textbf{сбалансированной} (равновероятной)
	
	\[ P(g = 0) = \frac{4}{8} = P(g = 1) \]

	Исследуем функцию $g$ на корреляционную иммунность. Для этого будет поочерёдно фиксировать значения переменных и считать вероятность получения $0$ до тех пока она не станет отличной от $0.5$.
	
	\begin{align*}
		P\bigl( g(x,y,z) = 0\ |\ x = 0\bigr) &= P(1\oplus y \oplus z = 0) = \frac{1}{2} \\ 
		P\bigl( g(x,y,z) = 0\ |\ x = 1\bigr) &= P(1\oplus y = 0) = \frac{1}{2} \\[2ex]
		P\bigl( g(x,y,z) = 0\ |\ y = 0\bigr) &= P(1 \oplus z \oplus x z\ = 0) = \frac{3}{4} \\ 
		P\bigl( g(x,y,z) = 0\ |\ y = 1\bigr) &= P(z \oplus x z = 0) = \frac{1}{4} \\[2ex]
		P\bigl( g(x,y,z) = 0\ |\ z = 0\bigr) &= P(1 \oplus y = 0) = \frac{1}{2} \\ 
		P\bigl( g(x,y,z) = 0\ |\ z = 1\bigr) &= P(y \oplus x = 0) = \frac{1}{2} 
	\end{align*}
	
	Из вычислений выше видно, что фиксация переменной $y$ вероятность отклоняется от исходной. А значит функция $g$ \textbf{не} является \textbf{корреляционно-иммунной}.

	Вспомним, что произвольная булева функция $f$ является $k$-устойчивой тогда и только тогда, когда она корреляционно-иммунная порядка $k$ и равновероятна. Из рассуждений выше следует, что функция $g$ также \textbf{не} является \textbf{устойчивой}.
	
	Исследуем функцию $g$ на наличие запретов. Для этого в пакете Wolfram Mathematica будем перебирать всевозможные выходные последосвательности разной длинны и пытаться решить систему уравнений относительно ячеек регистра сдвига. В результате такого исследования были найдены следующие невозможные выходные гаммы.
	
	\begin{align*}
		&001000\dots  & &1001000\dots\\
		&111000\dots  & &0111000\dots\\
		&0001000\dots & &1111000\dots 
	\end{align*}

	Из наличия запретов следует, что функция $g$ \textbf{не} является \textbf{сильноравновероятной}.
	

	\subsubsection{Наилучшее приближение линейной функцией}
	
	TO DO
	
	\subsubsection{Строгий лавинный критерий}
	
	Исследуем насколько сильно изменяются значения булевой функции $g(x, y, z)$ при малом изменении значений входных переменных. Для этого расчитаем производые по направлениям координатных веторов в $V_3$
	
	\begin{table}[h!]
		\begin{center}
			\begin{tabular}{|c|c|c||c||c|c|c|}
				\hline
				$ \pmb{x} $ & $ \pmb{y} $ & $ \pmb{z} $ & $ \pmb{g} $ & $ \pmb{D_x g} $ & $ \pmb{D_y g} $ & $ \pmb{D_z g} $ \\ \hline
				0 & 0 & 0 & 1 & 1 & 0 & 0 \\ \hline
				0 & 0 & 1 & 0 & 1 & 1 & 1 \\ \hline
				0 & 1 & 0 & 0 & 0 & 1 & 1 \\ \hline
				0 & 1 & 1 & 1 & 0 & 0 & 0 \\ \hline
				1 & 0 & 0 & 1 & 1 & 0 & 1 \\ \hline
				1 & 0 & 1 & 1 & 0 & 0 & 1 \\ \hline
				1 & 1 & 0 & 0 & 0 & 1 & 0 \\ \hline
				1 & 1 & 1 & 0 & 1 & 1 & 0 \\ \hline				
			\end{tabular}
		\end{center}
	\end{table}
	
	Таблица выше демонстирует, что все производные по направлениям координатных веторов в $V_3$ \textbf{сбалансированы}. Это значит, что булева функция $g$ удовлетворяет \textbf{строгому лавинному критерию}.
	
	Теперь исследуем поведение фунции $g$ по всем остальным направлениям.
	
		
	\begin{table}[h!]
		\begin{center}
			\begin{tabular}{|c|c|c||c||c|c|c|c|}
				\hline
				$ \pmb{x} $ & $ \pmb{y} $ & $ \pmb{z} $ & $ \pmb{g} $ & $ \pmb{D_{(1,1,0)} g} $ & $ \pmb{D_{(1,0,1)} g} $ & $ \pmb{D_{(0,1,1)} g} $ & $ \pmb{D_{(1,1,1)} g} $ \\ \hline
				0 & 0 & 0 & 1 & 0 & 1 & 1 & 0 \\ \hline
				0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 \\ \hline
				0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 \\ \hline
				0 & 1 & 1 & 1 & 1 & 0 & 1 & 1 \\ \hline
				1 & 0 & 0 & 1 & 0 & 0 & 0 & 1 \\ \hline
				1 & 0 & 1 & 1 & 1 & 1 & 0 & 0 \\ \hline
				1 & 1 & 0 & 0 & 1 & 1 & 1 & 0 \\ \hline
				1 & 1 & 1 & 0 & 0 & 0 & 1 & 1 \\ \hline				
			\end{tabular}
		\end{center}
	\end{table}
	
	Легко видеть, что производные по \textbf{всем} направлениям \textbf{сбалансирваны}. Это означает, что булева функция $g$ \textbf{удовлетворяет критерию распространения степени 3}.
	
	\section{Методы восстановления ключа}
	
	Зафиксируем параметры согласно размышлениям из пунктов \ref{Узлы РСЛОС} и \ref{Функции усложнения} и исследуем применимость разных методов для восстановления ключа. Для каждого алгоритма вычислим его характеристики.
	
	Через $G(K, n)$ будем обозначать выработку гаммы $\Gamma$ длинны $n$ представленным поточным алгоритмом шифрования на ключе $K$. Количество материала, необходимое для однозначного определения ключа составляет $m=log_2(|K|)=83$ бита.
	
	\subsection{Метод тотального опробования}
	
	Самым наивным вариантом восстановления ключа будет алгоритм тотального опробования, который применим абсолютно к любому шифру. Идея алготима заключается в переборе всевозможных ключей и сопоставлении полученной гаммы с известным материалом.

	\begin{algorithm}[H]
		
		\caption{Метод тотального опробования}
		\label{alg:Total}
		\SetAlgoNoEnd
		
		\KwData{Пара открытый и шифрованный текст $P, C \in V_{83}$}
		\KwResult{Ключ шифрования $K$}
		
		\ForEach{$k_1 \in V_{31}$}{ 
			\ForEach{$k_2 \in S (13)$}{ 
				\ForEach{$k_3 \in V_{19}$}{ 
					Сформировать ключ $K=(k_1, k_2, k_3)$
					
					Вычислить $\Gamma = G(K, n)$ \\
					\If{$P \oplus C = \Gamma$,}{
						Закончить алгоритм и вернуть $K$
					}
				}
			}
		}
	\end{algorithm}	
	
	
	\textbf{Вероятность работы} алгоритма $p(A)=1$, поскольку алгоритм гарантированно находит ключ. 
	
	\textbf{Средняя трудоёмкость} алгоритма $S(A)=\frac{2^{31} \cdot 13! \cdot 2^{19} + 1}{2} $. Она же равна \textbf{трудоёмкости по Шеннону} $Q(A)$.
	
	\textbf{Объём памяти} необходимый для работы алгоритма $M(A) = O(1)$, поскольку алгоритм хранит только локальные переменные.
	
	
		
\end{document}